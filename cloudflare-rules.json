{
  "description": "Cloudflare Cache Rules for James & Oliver's Wedding Site",
  "rules": [
    {
      "name": "HTML Files - No Cache",
      "expression": "(http.host eq \"your-domain.com\" and http.request.uri.path matches \"^.*\\.(html|htm)$\")",
      "action": "Cache Level: Bypass",
      "headers": {
        "Cache-Control": "no-cache, no-store, must-revalidate",
        "Pragma": "no-cache",
        "Expires": "0"
      }
    },
    {
      "name": "Content-Hashed Assets - Long Cache",
      "expression": "(http.host eq \"your-domain.com\" and http.request.uri.path matches \"^/assets/.*\\.[a-f0-9]{8}\\..*$\")",
      "action": "Cache Level: Cache Everything",
      "edge_ttl": 31536000,
      "browser_ttl": 31536000,
      "headers": {
        "Cache-Control": "public, max-age=31536000, immutable"
      }
    },
    {
      "name": "Non-Hashed CSS/JS - Short Cache",
      "expression": "(http.host eq \"your-domain.com\" and http.request.uri.path matches \"^.*\\.(css|js)$\")",
      "action": "Cache Level: Cache Everything",
      "edge_ttl": 3600,
      "browser_ttl": 3600,
      "headers": {
        "Cache-Control": "public, max-age=3600, must-revalidate"
      }
    },
    {
      "name": "Images - Moderate Cache",
      "expression": "(http.host eq \"your-domain.com\" and http.request.uri.path matches \"^.*\\.(jpg|jpeg|png|gif|webp|svg|ico)$\")",
      "action": "Cache Level: Cache Everything",
      "edge_ttl": 86400,
      "browser_ttl": 86400,
      "headers": {
        "Cache-Control": "public, max-age=86400, must-revalidate"
      }
    },
    {
      "name": "Fonts - Long Cache",
      "expression": "(http.host eq \"your-domain.com\" and http.request.uri.path matches \"^.*\\.(woff|woff2|ttf|eot)$\")",
      "action": "Cache Level: Cache Everything",
      "edge_ttl": 31536000,
      "browser_ttl": 31536000,
      "headers": {
        "Cache-Control": "public, max-age=31536000, immutable",
        "Access-Control-Allow-Origin": "*"
      }
    },
    {
      "name": "Version Files - No Cache",
      "expression": "(http.host eq \"your-domain.com\" and http.request.uri.path matches \"^/(version\\.json|manifest\\.json)$\")",
      "action": "Cache Level: Bypass",
      "headers": {
        "Cache-Control": "no-cache, no-store, must-revalidate",
        "Pragma": "no-cache",
        "Expires": "0"
      }
    },
    {
      "name": "Service Worker - No Cache",
      "expression": "(http.host eq \"your-domain.com\" and http.request.uri.path eq \"/sw.js\")",
      "action": "Cache Level: Bypass",
      "headers": {
        "Cache-Control": "no-cache, no-store, must-revalidate",
        "Pragma": "no-cache",
        "Expires": "0"
      }
    }
  ],
  "transform_rules": [
    {
      "name": "Security Headers",
      "expression": "(http.host eq \"your-domain.com\")",
      "headers": {
        "X-Frame-Options": "SAMEORIGIN",
        "X-Content-Type-Options": "nosniff",
        "X-XSS-Protection": "1; mode=block",
        "Referrer-Policy": "strict-origin-when-cross-origin"
      }
    }
  ]
}
